<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Plant Disease Classifier</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <header>
        <h1>üåø Plant Disease Classifier</h1>
    </header>

    <div class="container">
        <!-- Upload Form -->
        <form method="POST" enctype="multipart/form-data" class="upload-box">
            <input type="file" name="file" accept="image/*" onchange="previewImage(event)" required><br>
            <button type="submit" class="btn">Classify</button>
        </form>
        <div id="preview-container" class="grid"></div>

            <!-- Grid layout -->
            {% if plant_name %}
            <div class="grid" id="result-grid">
                <!-- Left card: Uploaded image -->
                <div class="card">
                    <h3>üì∏ Uploaded Image</h3>
                    <img src="{{ uploaded_image }}" alt="Uploaded Image">
                </div>

                <!-- Right card: Prediction results -->
                <div class="card">
                    <h3>üìä Prediction Results</h3>

                    <!-- Plant Name & Status -->
                    <p><strong>Plant:</strong> {{ plant_name }}</p>
                    <p><strong>Status:</strong>
                        {% if status == 'healthy' %}
                            ‚úÖ Healthy
                        {% else %}
                            ‚ö†Ô∏è Disease
                        {% endif %}
                    </p>

                    <!-- Disease Name -->
                    {% if disease_name %}
                        <p><strong>Disease:</strong> {{ disease_name }}</p>
                    {% endif %}

                    <!-- Confidence -->
                    <p><strong>Confidence:</strong> {{ confidence }}%</p>
                    <div class="progress-bar">
                        <div class="progress" style="width: {{ confidence }}%;"></div>
                    </div>

                    <!-- Alternatives -->
                    {% if alternatives %}
                        <h4>üîÑ Alternatives:</h4>
                        <ul>
                            {% for alt, score in alternatives %}
                                <li>{{ alt }} ({{ score }}%)</li>
                            {% endfor %}
                        </ul>
                    {% endif %}

                    <!-- Recommendation -->
                    {% if recommendation %}
                        <p class="recommend"><strong>üí° Recommendation:</strong> {{ recommendation }}</p>
                    {% endif %}
                </div>     
            </div>
            {% endif %}
        </div>

    <script>
    function previewImage(event) {
        let reader = new FileReader();
        reader.onload = function() {
            let container = document.getElementById('preview-container');
            container.innerHTML = `
                <div class="card preview-card">
                    <h3>Preview</h3>
                    <img src="${reader.result}" style="width:100%; height:250px; object-fit:cover;">
                </div>
            `;

            // Clear previous prediction results
            let resultGrid = document.getElementById('result-grid');
            if (resultGrid) {
                resultGrid.remove();
            }
        }
        reader.readAsDataURL(event.target.files[0]);
    }
    </script>

</body>
<!-- Footer -->
<footer>
    Made with ‚ù§Ô∏è by Taiyaba Khan<br>
    AI Internship Project at IBM-PBEL
</footer>
</html>
